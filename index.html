<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="push.js"></script>

</head>

<body>
    <div id="navbar"><span>Pragmatic Coders: Notification example</span></div>
    <span id="wrapper">
        <button id="notify-button">Notify Me!!</button>
        <button id="clear-button">Clear All!</button>
        <button id="check-button">Check Permission</button>
        <button id="button-interaction">Change interaction</button>
        <span>require interaction:</span><span id="interaction">true</span>
        <!-- <button id="interval">Start/Stop interval</button> -->
    </div>

    <script>
        var globalInterval = false;
        var setIntervalFlag;
        var requireInteraction = true;

        function rand(min, max) {
            min = parseInt(min, 10);
            max = parseInt(max, 10);

            if (min > max) {
                var tmp = min;
                min = max;
                max = tmp;
            }

            return Math.floor(Math.random() * (max - min + 1) + min);
        }
        $("#notify-button").click(function () {
            Push.create(`Notification: ${rand(1, 100)}`, {
                body: "Pragmatic Coders example notification www.test.pl Test loremEnim Lorem labore amet adipisicing. Tempor irure laborum adipisicing ullamco id dolore aute culpa enim ad. Ut do aliquip incididunt do labore consectetur id elit fugiat ex minim eu anim. Qui fugiat officia esse sunt tempor est reprehenderit. Elit occaecat anim elit est elit tempor ut. Do dolore ad exercitation culpa voluptate sunt aliqua exercitation deserunt occaecat aliquip magna. Mollit voluptate commodo consectetur eiusmod incididunt aliquip exercitation consequat incididunt pariatur elit ipsum ipsum Lorem. Nisi tempor ullamco veniam fugiat ea in cillum ut dolor consequat anim.</a>",
                // timeout: 100000000000,
                requireInteraction: requireInteraction,
                link: "www.dupa.50.io",
                icon: './test.png',
                onClick: function () {
                    window.focus();
                    // alert("Redirect");
                    // window.location.href = "http://pragmaticcoders.com";
                },
                onShow: function () {
                    // alert("show");
                }
            });
        });
        $("#clear-button").click(function () {
            Push.clear();
        });
        $("#check-button").click(function () {
            console.log(Push.Permission.has());
        });

        $('#button-interaction').click(function () {
            requireInteraction = !requireInteraction;

            changeInteraction();
        });

        var changeInteraction = function() {
            $('#interaction').text(requireInteraction);
        }

        // setInterval(function () {
        //     $("#notify-button").click()
        // }, 3000);

        // $("#interval").click(() => {
        //     globalInterval = !globalInterval;
        //     console.log(globalInterval, setIntervalFlag)
        //     if(globalInterval) {
        //         setIntervalFlag = setInterval(function () {
        //             $("#notify-button").click()
        //         }, 3000);
        //     } else {
        //         clearInterval(setIntervalFlag);
        //     }
        // })
        // console.log(globalInterval, setIntervalFlag)
    </script>
</body>

</html>